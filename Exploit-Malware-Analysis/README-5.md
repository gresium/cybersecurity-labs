# Mastering-Cyber-Intrusion-Exploiting-Systems-with-Metasploit-Ngrok-and-Malware-Analysis

# A full offensive security engagement demonstrating payload generation, remote access exploitation, tunneling through NAT, and analyzing post-exploitation behavior.
Overview
This project showcases a complete cyber intrusion workflow using industry-grade offensive tools. The objective was to simulate how an attacker gains remote access to a target machine, bypass network restrictions, and analyze the behavior of the generated malicious payload.
The work integrates Metasploit Framework, tunneling with Ngrok, and controlled malware execution within a safe testing environment.

# Objectives
• Create and configure malicious payloads
• Establish remote shells using Metasploit
• Bypass NAT limitations using Ngrok tunneling
• Conduct exploitation against a target virtual machine
• Analyze post-exploitation capabilities
• Observe malware behavior in a controlled lab environment
• Document exploitation paths and mitigation steps

# Environment
• Windows 10 VM (target)
• Kali Linux VM (attacker)
• Metasploit Framework
• Ngrok tunneling service
• NAT network environment
• Controlled malware analysis setup

# Tools Used
• Metasploit Framework (msfvenom, msfconsole)
• Ngrok
• Windows Defender (for detection behavior testing)
• Process Explorer / Task Manager
• TCPView
• Wireshark (optional)
• PowerShell

# Methodology

# 1. Payload Generation
Used msfvenom to craft a reverse shell payload:
• Format: EXE
• Payload: windows/meterpreter/reverse_tcp
• Host: forwarded via Ngrok tunnel
• Port: dynamically mapped
• Obfuscation applied through encoding options to bypass basic AV
The malicious EXE was transferred to the target machine for testing.

# 2. Ngrok Tunneling
Configured Ngrok to forward traffic from the public internet to the attacker VM, bypassing NAT and private IP constraints.
• Verified external tunnel URL
• Mapped tunnel output to Metasploit listener
• Ensured stable connectivity between target and attacker

# 3. Metasploit Listener Setup
Launched msfconsole and prepared a handler:
• Set payload parameters
• Configured LHOST to Ngrok’s public URL
• Started exploit/multi/handler
• Verified listener readiness

# 4. Execution & Exploitation
On the target VM:
• Executed the payload
• Observed callback reaching Ngrok
• Received a Meterpreter session on attacker machine
• Stabilized shell and elevated privileges where possible

# 5. Post-Exploitation
Performed controlled post-exploitation actions:
• System information collection
• Screenshot capture
• File enumeration
• Persistence exploration (not activated for safety)
• Network enumeration
• Process inspection

# 6. Malware Behavior Analysis
Assessed how the payload behaved on Windows:
• Defender reaction and detection logs
• Process tree creation
• Network traffic patterns
• Indicators of compromise (IOCs)
• Registry touches
• PE file inspection

# This confirmed typical behaviors of reverse-shell malware.
Key Findings
Reverse-shell payloads can bypass NAT using tunneling services
Windows Defender may not always detect custom-encoded payloads
Meterpreter provides extensive post-exploitation capability
Ngrok introduces additional attack surface via public exposure
User awareness and endpoint security are critical controls

# Recommendations
• Enforce application execution restrictions (AppLocker)
• Disable unknown tunneling services
• Use advanced endpoint protection with behavioral detection
• Monitor outbound connections to rare or suspicious domains
• Educate users against executing unknown attachments
• Implement network egress filtering

/Cyber-Intrusion-Metasploit-Ngrok
│
├── payload/
│   ├── payload.exe
│   └── msfvenom-command.txt
│
├── analysis/
│   ├── defender-alerts.txt
│   ├── process-tree.png
│   └── network-traffic.pcap
│
├── exploitation/
│   ├── handler-setup.md
│   └── session-commands.txt
│
└── README.md

Author
Developed by Gresa Hisa (@gresium)
AI & Cybersecurity Engineer 
GitHub: https://github.com/gresium
